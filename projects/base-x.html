<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Base-X - Blog</title>
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism-tomorrow.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
</head>

<body>
    <nav class="navbar navbar-expand-lg fixed-top" data-bs-theme="light">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="../index.html#header" aria-label="Accueil">
                <img src="../images/avatar.jpg" width="40" height="40" alt="Avatar Basil L'H√¥te"
                    class="rounded-circle me-2">
                <span class="d-none d-md-inline">Basil L'H√îTE</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../index.html#about">√Ä propos</a></li>
                    <li class="nav-item"><a class="nav-link" href="../index.html#portfolio">Portfolio</a></li>
                    <li class="nav-item"><a class="nav-link" href="../index.html#skills">Comp√©tences</a></li>
                    <li class="nav-item"><a class="nav-link" href="../index.html#contact">Contact</a></li>

                    <li class="nav-item">
                        <button id="theme-toggle" class="btn btn-sm btn-outline-secondary ms-2"
                            aria-label="Changer le th√®me">
                            <i class="fas fa-moon"></i>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container py-5">
        <h1 class="text-center mb-4 mt-4">Base-X</h1>
        <p class="text-center text-muted mb-5">Un jeu mobile 3D d√©velopp√© avec Godot. Suivez ici son √©volution technique
            et cr√©ative.</p>

        <div class="text-center mt-5 mb-5">
            <a href="https://github.com/LBasil/baseX" target="_blank" class="btn btn-outline-secondary">‚Üê Lien vers le
                projet</a>
        </div>

        <section id="blog">
            <h2 class="mb-4">Journal de d√©veloppement</h2>

            <article class="mb-5 p-4 border rounded shadow-sm">
                <div class="blog-header d-flex justify-content-between align-items-center">
                    <h3 class="h5">D√©placement 3D et vue plongeante dynamique</h3>
                    <button class="btn btn-link toggle-content">
                        <span class="fa fa-chevron-down"></span>
                    </button>
                </div>
                <p class="text-muted small">Publi√© le 12 avril 2025</p>

                <div class="blog-content" style="display: none;">
                    <p>
                        Aujourd‚Äôhui, j‚Äôai pos√© les bases du syst√®me de d√©placement 3D du personnage, ainsi qu‚Äôune cam√©ra
                        dynamique en vue plongeante. Ces deux √©l√©ments sont essentiels car ils d√©finissent √† la fois le
                        gameplay et la sensation de navigation dans l‚Äôunivers suspendu de <strong>Base-X</strong>.
                    </p>

                    <p>
                        Pour le d√©placement, j‚Äôutilise un <code>CharacterBody3D</code> dans Godot. L‚Äôobjectif √©tait
                        d‚Äôavoir
                        un mouvement fluide, r√©actif, mais pas rigide. J‚Äôai donc int√©gr√© une acc√©l√©ration avec
                        <code>lerp</code> pour adoucir les transitions, et un syst√®me de rotation automatique du
                        personnage
                        dans la direction du mouvement :
                    </p>

                    <pre><code class="language-gdscript">velocity.x = lerp(velocity.x, direction.x * speed, acceleration * delta)
    rotation.y = lerp_angle(rotation.y, atan2(velocity.x, velocity.z), 10.0 * delta)
                    </code></pre>

                    <p>
                        Ce syst√®me permet de cr√©er une vraie inertie dans le contr√¥le : le personnage ne tourne pas
                        instantan√©ment mais s‚Äôoriente progressivement, ce qui est plus naturel en 3D. La gravit√© est
                        √©galement g√©r√©e manuellement pour plus de contr√¥le, en particulier dans des environnements
                        suspendus
                        o√π le sol n‚Äôest pas toujours garanti.
                    </p>

                    <p>
                        C√¥t√© cam√©ra, j‚Äôai mis en place un script simple bas√© sur un <code>Camera3D</code> qui suit en
                        temps
                        r√©el le joueur gr√¢ce √† une r√©f√©rence export√©e <code>@export var target: Node3D</code>. La cam√©ra
                        est
                        positionn√©e avec un d√©calage (offset) au-dessus et derri√®re le personnage, pour cr√©er une
                        <strong>vue plongeante</strong> immersive :
                    </p>

                    <pre><code class="language-gdscript">global_transform.origin = target.global_transform.origin + offset
                    </code></pre>

                    <p>
                        Ce syst√®me est l√©ger, adaptable et parfait pour un jeu mobile o√π la lisibilit√© est cruciale. La
                        vue
                        plongeante donne une bonne perception de l‚Äôenvironnement tout en gardant le joueur toujours
                        visible
                        et centr√©.
                    </p>
                </div>
            </article>

            <article class="mb-5 p-4 border rounded shadow-sm">
                <div class="blog-header d-flex justify-content-between align-items-center">
                    <h3 class="h5">Collisions pr√©cises avec les murs</h3>
                    <button class="btn btn-link toggle-content">
                        <span class="fa fa-chevron-down"></span>
                    </button>
                </div>
                <p class="text-muted small">Publi√© le 13 avril 2025</p>

                <div class="blog-content" style="display: none;">
                    <p>
                        Aujourd‚Äôhui, j‚Äôai impl√©ment√© un syst√®me de collision r√©aliste entre le joueur et les murs.
                        Jusqu‚Äô√†
                        pr√©sent, le personnage pouvait traverser tout librement, ce qui convenait aux tests de
                        navigation,
                        mais emp√™chait toute notion de level design. C‚Äôest d√©sormais corrig√©.
                    </p>

                    <p>
                        Les murs sont mod√©lis√©s avec des <code>MeshInstance3D</code> (des cubes pour le moment), et
                        chaque
                        mesh est accompagn√© d‚Äôun <code>CollisionShape3D</code> (g√©n√©ralement une bo√Æte) pour g√©rer les
                        interactions physiques. Ces formes sont simples mais suffisantes pour d√©tecter les chocs et
                        emp√™cher
                        toute travers√©e.
                    </p>

                    <p>
                        En pratique, cela change radicalement la sensation de jeu : le joueur sent qu‚Äôil √©volue dans un
                        espace structur√©, avec des limites claires et des contraintes √† respecter. C‚Äôest aussi la
                        premi√®re
                        √©tape vers des niveaux plus complexes avec des zones ferm√©es, des couloirs, voire des puzzles
                        physiques.
                    </p>
                </div>
            </article>

            <article class="mb-5 p-4 border rounded shadow-sm">
                <div class="blog-header d-flex justify-content-between align-items-center">
                    <h3 class="h5">Essais multijoueur avec Godot</h3>
                    <button class="btn btn-link toggle-content">
                        <i class="fa fa-chevron-down"></i>
                    </button>
                </div>
                <p class="text-muted small">Publi√© le 14 avril 2025</p>

                <div class="blog-content" style="display: none;">
                    <p>
                        J‚Äôai commenc√© √† exp√©rimenter avec le multijoueur dans Godot pour mieux comprendre comment
                        fonctionne leur syst√®me r√©seau int√©gr√©.
                        M√™me si le projet final utilisera s√ªrement un serveur plus robuste, je voulais me faire la main
                        sur l'approche
                        "serveur embarqu√©" de Godot, en mode peer-to-peer avec autorit√©.
                    </p>

                    <h6>üß™ Architecture de base</h6>

                    <p>
                        J‚Äôai mis en place une logique de client/serveur assez simple avec
                        <code>ENetMultiplayerPeer</code>. Selon si on h√©berge ou rejoint,
                        on configure le peer comme serveur ou client. Ensuite, on g√®re les connexions et les
                        d√©connexions, et on instancie les joueurs.
                    </p>

                    <pre><code class="language-gdscript">func start_server():
                  var peer = ENetMultiplayerPeer.new()
                  var error = peer.create_server(PORT, MAX_PLAYERS)
                  if error:
                      print("Erreur serveur : ", error)
                      return
                  multiplayer.multiplayer_peer = peer
                  multiplayer.peer_connected.connect(_on_peer_connected)
                  multiplayer.peer_disconnected.connect(_on_peer_disconnected)</code></pre>

                    <p>
                        Le client, lui, se connecte et instancie son joueur local directement :
                    </p>

                    <pre><code class="language-gdscript">func start_client(ip):
                  var peer = ENetMultiplayerPeer.new()
                  var error = peer.create_client(ip, PORT)
                  if error:
                      print("Erreur client : ", error)
                      return
                  multiplayer.multiplayer_peer = peer
                  multiplayer.peer_connected.connect(_on_peer_connected)
                  multiplayer.peer_disconnected.connect(_on_peer_disconnected)
                  spawn_player(multiplayer.get_unique_id())</code></pre>

                    <h6>üëæ Spawning & autorit√©</h6>

                    <p>
                        D√®s qu‚Äôun joueur rejoint, on cr√©e une instance de son personnage avec une autorit√© r√©seau unique
                        (son ID) :
                    </p>

                    <pre><code class="language-gdscript">func spawn_player(id):
                  var player_scene = load("res://player.tscn")
                  var player = player_scene.instantiate()
                  player.name = str(id)
                  player.position = Vector3(randi_range(-5, 5), 1.5, randi_range(-5, 5))
                  var root = get_tree().root.get_node("Node3D")
                  root.add_child(player)
                  players[id] = player
                  player.set_multiplayer_authority(id)</code></pre>

                    <h6>üì° Synchronisation et RPCs</h6>

                    <p>
                        Pour que les positions des joueurs soient partag√©es entre tous les clients, j‚Äôai mis en place un
                        syst√®me de synchronisation
                        manuelle √† base de RPCs.
                    </p>

                    <p>
                        D'abord, seul le client qui poss√®de l'autorit√© r√©seau sur son personnage (souvent lui-m√™me)
                        envoie sa position :
                    </p>

                    <pre><code class="language-gdscript">func _physics_process(delta):
                  if multiplayer.get_unique_id() == get_multiplayer_authority():
                      ...
                      rpc("update_position", position, rotation)</code></pre>

                    <p>
                        Et c√¥t√© r√©ception, tous les autres clients mettent √† jour leur version du joueur :
                    </p>

                    <pre><code class="language-gdscript">@rpc("any_peer", "call_remote")
              func update_position(pos, rot):
                  if multiplayer.get_unique_id() != get_multiplayer_authority():
                      position = pos
                      rotation = rot</code></pre>

                    <h6>üìå Quelques pr√©cisions sur les annotations @rpc</h6>

                    <p>
                        La magie dans tout √ßa, ce sont les annotations <code>@rpc</code>. C‚Äôest ce qui rend une fonction
                        appelable √† distance.
                        Tu peux pr√©ciser plusieurs choses :
                    </p>

                    <ul>
                        <li><code>@rpc("any_peer")</code> : signifie que cette m√©thode peut √™tre appel√©e par n‚Äôimporte
                            quel peer, pas uniquement le serveur.</li>
                        <li><code>@rpc("authority")</code> : seule l‚Äôautorit√© du n≈ìud peut appeler la fonction √†
                            distance.</li>
                        <li><code>@rpc("call_remote")</code> : force √† ex√©cuter la fonction uniquement sur les autres
                            peers, pas localement.</li>
                    </ul>

                    <p>
                        Donc dans notre cas, <code>@rpc("any_peer", "call_remote")</code> permet √† chaque joueur
                        d‚Äôenvoyer sa position aux autres, mais
                        de ne pas ex√©cuter <code>update_position()</code> sur lui-m√™me. C‚Äôest super utile pour √©viter
                        les doublons ou les comportements bizarres.
                    </p>

                    <h6>üß± Prochaine √©tape</h6>

                    <p>
                        L√†, tout le monde peut se d√©placer mais seul le serveur voit les deux en m√™me temps (peut √™tre
                        car j'aurais du cr√©er un troisi√®me projet client). C‚Äôest fluide, pas de d√©synchro visible.
                        Prochaine √©tape :
                        rendre l‚Äôenvironnement interactif (casser, poser des blocs, etc).
                    </p>
                </div>
            </article>

            <article class="mb-5 p-4 border rounded shadow-sm">
                <div class="blog-header d-flex justify-content-between align-items-center">
                  <h3 class="h5">Destruction & Rebuild de murs</h3>
                  <button class="btn btn-link toggle-content">
                    <i class="fa fa-chevron-down"></i>
                  </button>
                </div>
                <p class="text-muted small">Publi√© le 15 avril 2025</p>
              
                <div class="blog-content" style="display: none;">
                  <p>
                    Nouvelle fonctionnalit√© test√©e : la possibilit√© de d√©truire un mur quand on vise dessus et qu'on est assez proche,
                    puis de le reconstruire au m√™me endroit avec une autre touche.
                  </p>
              
                  <h6>üéÆ Objectif</h6>
                  <ul>
                    <li>Interaction au clic clavier selon la distance et la vis√©e.</li>
                    <li>Masquage visuel (<code>hide()</code>) et d√©sactivation de collision.</li>
                    <li>Possibilit√© de restaurer l‚Äôobjet au m√™me endroit.</li>
                  </ul>
              
                  <h6>üëÅÔ∏è D√©tection du regard + distance</h6>
                  <p>
                    J‚Äôutilise un raycast depuis la souris pour savoir si le joueur "vise" bien le mur.
                    On v√©rifie aussi qu‚Äôil est assez proche via la distance 3D.
                  </p>
              
                  <pre><code class="language-gdscript">func is_aimed_by_mouse() -> bool:
                  var mouse_pos = get_viewport().get_mouse_position()
                  var ray_origin = camera.project_ray_origin(mouse_pos)
                  var ray_direction = camera.project_ray_normal(mouse_pos)
                  var ray_end = ray_origin + ray_direction * 100.0
                  var query = PhysicsRayQueryParameters3D.create(ray_origin, ray_end)
                  query.collision_mask = 1
                  var result = get_world_3d().direct_space_state.intersect_ray(query)
                  
                  if not is_destroyed:
                      return result and result.collider == self
                  else:
                      if result:
                          var hit_point = result.position
                          return hit_point.distance_to(original_position) < aim_tolerance
                  return false</code></pre>
              
                  <h6>üß± Fonctionnement</h6>
                  <p>
                    Le mur est un <code>StaticBody3D</code> avec un collider. Il peut √™tre cach√© et d√©sactiv√©
                    (simulation de "d√©truit"), ou visible et actif ("reconstruit").
                  </p>
              
                  <pre><code class="language-gdscript">func destroy_wall():
                  hide()
                  $WallCollision.disabled = true
                  is_destroyed = true
              
              func rebuild_wall():
                  show()
                  $WallCollision.disabled = false
                  global_transform.origin = original_position
                  is_destroyed = false</code></pre>
              
                  <h6>üßí Interaction du joueur</h6>
                  <p>
                    La touche <code>destroy_wall</code> permet de d√©truire si on vise bien, assez proche, et que le mur est encore debout.
                    Inversement pour <code>rebuild_wall</code>.
                  </p>
              
                  <pre><code class="language-gdscript">func _process(delta):
                  if Input.is_action_just_pressed("destroy_wall") and not is_destroyed and distance_to_player < interaction_distance and is_aimed:
                      destroy_wall()
                  if Input.is_action_just_pressed("rebuild_wall") and is_destroyed and distance_to_player < interaction_distance and is_aimed:
                      rebuild_wall()</code></pre>
              
                  <h6>üß¨ Instanciation de plusieurs murs</h6>
                  <p>
                    Je me suis aussi pench√© sur comment instancier plusieurs murs dynamiquement dans la sc√®ne.
                    J'ai donc instanci√© le noeud Wall et j'ai  cr√©e un noeud Walls qui appelle des instances de Wall.
                    Ainsi sous "Walls", j'ai un enfant "Wall1" et un enfant "Wall2"
                    √áa ouvre la voie √† une vraie base de construction, avec placement dynamique, interaction, destruction, etc.
                  </p>
                </div>
              </article>
              

        </section>

        <div class="text-center mt-5">
            <a href="../index.html" class="btn btn-outline-secondary">‚Üê Retour au portfolio</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/prism.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script> <!-- Pour les ic√¥nes de fl√®che -->
    <script>
        // Fonction de bascule pour afficher/masquer le contenu
        document.querySelectorAll('.toggle-content').forEach(button => {
            button.addEventListener('click', function () {
                const content = this.closest('article').querySelector('.blog-content');
                const icon = this.querySelector('span');
                if (content.style.display === 'none' || content.style.display === '') {
                    content.style.display = 'block';
                    icon.classList.remove('fa-chevron-down');
                    icon.classList.add('fa-chevron-up');
                } else {
                    content.style.display = 'none';
                    icon.classList.remove('fa-chevron-up');
                    icon.classList.add('fa-chevron-down');
                }
            });
        });
    </script>
    <script src="../script/navigation.js"></script>
</body>

</html>